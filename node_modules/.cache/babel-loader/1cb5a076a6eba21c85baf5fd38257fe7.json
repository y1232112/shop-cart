{"ast":null,"code":"import*as types from'../constants/actionTypes';import shop from'../apis/shop';var receiveProducts=function receiveProducts(products){return{type:types.RECEIVE_PRODUCTS,products:products};};export var getAllProducts=function getAllProducts(){return function(dispatch){shop.getProducts(function(products){dispatch(receiveProducts(products));});};};var getAvailPrdct=function getAvailPrdct(e,p){if(e.target.value===types.SELECT){return p[0];}else if(e.target.value===types.LOWEST_TO_HIGHEST){return p[1];}else if(e.target.value===types.HIGHEST_TO_LOWEST){return p[2];}else return p[0];};var getSortProduct=function getSortProduct(e,p){return{type:'SELECT_TYPE',selectChange:e.target.value,avaiProducts:p};};var resolveSize=function resolveSize(size,selectSize){if(selectSize.length==0){var initsize=[];initsize.push(size);return initsize;}else{var initsize=[size];var m=0;var p=initsize.concat(selectSize);for(var k=0;k<p.length;k++){if(p[k]==size){m++;}}if(m==2){var o=[];for(var g=0;g<p.length;g++){if(p[g]!==size){o.push(p[g]);}}return o;}else{return p;}}};var getSelectSize=function getSelectSize(s,p){return{type:types.SELECT_SIZE,selectSize:s,avaiProducts:p};};var getSelctSizPrdcts=function getSelctSizPrdcts(arr,products,selectChange){var ap=[];var temp=[];var pt=products.map(function(mp){return mp.availableSizes;});for(var i=0;i<arr.length;i++){for(var ti=0;ti<pt.length;ti++){for(var ai=0;ai<pt[ti].length;ai++){if(pt[ti][ai]==arr[i]){ap.push(products[ti]);}}}}/* ***************************************************** */ap=new Set(ap);ap=Array.from(ap);/* **************************************************** */ /* ----------------------------------------------- */ /* by id 保存avaiproducts副本*/var prdctById=[];for(var i=0;i<ap.length;i++){prdctById.push(ap[i]);}prdctById.sort(function(a,b){return a.id-b.id;});/* ----------------------------------------------- */ /* by price 价格从低到高排序*/var prdctsByPrice=[];for(var i=0;i<prdctById.length;i++){prdctsByPrice.push(prdctById[i]);}prdctsByPrice.sort(function(a,b){return a.price-b.price;});console.log('ProductsByPrice',prdctsByPrice);/* ----------------------------------------------- */ /* by reverse price 价格从高到低排序*/var reverseprdctByPrice=[];for(var m=prdctsByPrice.length-1;m>=0;m--){reverseprdctByPrice.push(prdctsByPrice[m]);}console.log('reverseprdctByPrice',reverseprdctByPrice);var avaiProducts=[prdctById,prdctsByPrice,reverseprdctByPrice];/* ********************************************************************************** */if(selectChange==types.HIGHEST_TO_LOWEST){return avaiProducts[2];}else if(selectChange==types.LOWEST_TO_HIGHEST){return avaiProducts[1];}else return avaiProducts[0];};export var addSize=function addSize(size,selectSize,products,selectChange){return function(dispatch){dispatch(getSelectSize(resolveSize(size,selectSize),getSelctSizPrdcts(resolveSize(size,selectSize),products,selectChange)));};};export var onChangedSort=function onChangedSort(e,avaiProducts){return function(dispatch){dispatch(getSortProduct(e,getAvailPrdct(e,avaiProducts)));};};var toCart=function toCart(cartProduct,products){return{type:types.ADD_TO_CART,cartProduct:cartProduct,currentInventory:--cartProduct.inventory,products:products};};export var addToCart=function addToCart(cartProduct,products){return function(dispatch){dispatch(toCart(cartProduct,products));};};","map":{"version":3,"sources":["E:/shop-cart/src/actions/index.js"],"names":["types","shop","receiveProducts","products","type","RECEIVE_PRODUCTS","getAllProducts","dispatch","getProducts","getAvailPrdct","e","p","target","value","SELECT","LOWEST_TO_HIGHEST","HIGHEST_TO_LOWEST","getSortProduct","selectChange","avaiProducts","resolveSize","size","selectSize","length","initsize","push","m","concat","k","o","g","getSelectSize","s","SELECT_SIZE","getSelctSizPrdcts","arr","ap","temp","pt","map","mp","availableSizes","i","ti","ai","Set","Array","from","prdctById","sort","a","b","id","prdctsByPrice","price","console","log","reverseprdctByPrice","addSize","onChangedSort","toCart","cartProduct","ADD_TO_CART","currentInventory","inventory","addToCart"],"mappings":"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","sourcesContent":["import * as types from '../constants/actionTypes';\r\nimport shop from '../apis/shop';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst receiveProducts=products=>({\r\n    type:types.RECEIVE_PRODUCTS,\r\n    products\r\n})\r\nexport const getAllProducts=()=>dispatch=>{\r\n    shop.getProducts(\r\n        products=>{\r\n            dispatch(receiveProducts(products))\r\n        }\r\n    )\r\n}\r\n\r\n const getAvailPrdct=(e,p)=>{\r\n    if(e.target.value===types.SELECT){\r\n\r\n   return p[0]\r\n    }\r\n   else if(e.target.value===types.LOWEST_TO_HIGHEST){\r\n     \r\n        return p[1]\r\n    }\r\n    else if(e.target.value===types.HIGHEST_TO_LOWEST){\r\n        return p[2]\r\n    }\r\n    else return p[0]\r\n}\r\n\r\nconst getSortProduct=(e,p)=>({\r\n type:'SELECT_TYPE',\r\n selectChange:e.target.value,\r\navaiProducts:p\r\n\r\n})\r\n\r\nconst resolveSize=(size,selectSize)=>{\r\n   \r\n    if(selectSize.length==0){\r\n        var initsize=[];\r\n        initsize.push(size);\r\n        return initsize;\r\n    }else{\r\n        var initsize=[size];\r\n        var m=0;\r\n       var p=initsize.concat(selectSize)\r\n       for(var k=0;k<p.length;k++){\r\n          if(p[k]==size){\r\n              m++\r\n          }\r\n       }\r\n      if(m==2){\r\n          var o=[];\r\n          for(var g=0;g<p.length;g++){\r\n              if(p[g]!==size){\r\n                  o.push(p[g])\r\n              }\r\n          }\r\n          return o\r\n      }\r\n      else\r\n           {\r\n          \r\n           return p\r\n           }\r\n    }\r\n   \r\n\r\n}\r\n\r\nconst getSelectSize=(s,p)=>({\r\n    type:types.SELECT_SIZE,\r\n    selectSize:s,\r\n    avaiProducts:p\r\n})\r\nconst getSelctSizPrdcts=(arr,products,selectChange)=>{\r\n    var ap=[];\r\n    var temp=[];\r\n\r\n    var pt=products.map(mp=>mp.availableSizes);\r\n    for(var i=0;i<arr.length;i++){\r\n          for(var ti=0;ti<pt.length;ti++){\r\n            for(var ai=0;ai<pt[ti].length;ai++){\r\n                if(pt[ti][ai]==arr[i]){\r\n                    ap.push(products[ti])\r\n                }\r\n            }\r\n          }\r\n              \r\n          \r\n    }\r\n    /* ***************************************************** */\r\n    ap=new Set(ap);\r\n    ap=Array.from(ap) ;\r\n     /* **************************************************** */\r\n     /* ----------------------------------------------- */\r\n/* by id 保存avaiproducts副本*/\r\nvar prdctById=[];\r\nfor(var i=0;i<ap.length;i++){\r\n    prdctById.push(ap[i])\r\n}\r\nprdctById.sort(function(a,b){\r\n    return a.id-b.id;\r\n})\r\n\r\n/* ----------------------------------------------- */\r\n/* by price 价格从低到高排序*/\r\n\r\n  const prdctsByPrice=[];\r\nfor(var i=0;i<prdctById.length;i++){\r\n    prdctsByPrice.push(prdctById[i])\r\n}\r\n\r\n\r\nprdctsByPrice.sort(function(a,b){\r\n    return a.price-b.price;\r\n})\r\nconsole.log('ProductsByPrice',prdctsByPrice);\r\n/* ----------------------------------------------- */\r\n/* by reverse price 价格从高到低排序*/\r\nvar reverseprdctByPrice=[];\r\nfor(var m=prdctsByPrice.length-1;m>=0;m--){\r\n    reverseprdctByPrice.push(prdctsByPrice[m])\r\n}\r\n\r\nconsole.log('reverseprdctByPrice',reverseprdctByPrice)\r\n\r\nvar avaiProducts=[prdctById,prdctsByPrice,reverseprdctByPrice];\r\n     /* ********************************************************************************** */\r\n    if(selectChange==types.HIGHEST_TO_LOWEST){\r\n        return avaiProducts[2]\r\n    }else if(selectChange==types.LOWEST_TO_HIGHEST){\r\n        return avaiProducts[1]\r\n    }\r\n   else return avaiProducts[0];\r\n}\r\nexport const addSize=(size,selectSize,products,selectChange)=>dispatch=>{\r\n  dispatch(\r\n      getSelectSize(\r\n                       resolveSize(size,selectSize),\r\n                       getSelctSizPrdcts(resolveSize(size,selectSize),products,selectChange)\r\n                    )\r\n      )\r\n}\r\nexport const onChangedSort=(e,avaiProducts)=>dispatch=>{\r\n   dispatch(getSortProduct(e,getAvailPrdct(e,avaiProducts)))\r\n}\r\n\r\nconst toCart=(cartProduct,products)=>({\r\n    type:types.ADD_TO_CART,\r\n    cartProduct,\r\n    currentInventory:--cartProduct.inventory,\r\n    products,\r\n  \r\n    \r\n    \r\n})\r\n\r\nexport const addToCart=(cartProduct,products)=>dispatch=>{\r\n   dispatch(toCart(cartProduct,products))\r\n}"]},"metadata":{},"sourceType":"module"}